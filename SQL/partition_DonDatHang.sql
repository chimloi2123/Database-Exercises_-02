USE [HoaYeuThuong]
GO
BEGIN TRANSACTION
CREATE PARTITION FUNCTION [NgayDatFunc](datetime) AS RANGE RIGHT FOR VALUES (N'2000-01-01T00:00:00', N'2001-01-01T00:00:00', N'2002-01-01T00:00:00', N'2003-01-01T00:00:00', N'2004-01-01T00:00:00', N'2005-01-01T00:00:00', N'2006-01-01T00:00:00', N'2007-01-01T00:00:00', N'2008-01-01T00:00:00', N'2009-01-01T00:00:00', N'2010-01-01T00:00:00', N'2011-01-01T00:00:00', N'2012-01-01T00:00:00', N'2013-01-01T00:00:00', N'2014-01-01T00:00:00', N'2015-01-01T00:00:00', N'2016-01-01T00:00:00', N'2017-01-01T00:00:00', N'2018-01-01T00:00:00', N'2019-01-01T00:00:00', N'2020-01-01T00:00:00', N'2021-01-01T00:00:00', N'2022-01-01T00:00:00', N'2023-01-01T00:00:00')


CREATE PARTITION SCHEME [NgayDatSc] AS PARTITION [NgayDatFunc] TO ([PRIMARY], [PRIMARY], [PRIMARY], [PRIMARY], [PRIMARY], [PRIMARY], [PRIMARY], [PRIMARY], [PRIMARY], [PRIMARY], [PRIMARY], [PRIMARY], [PRIMARY], [PRIMARY], [PRIMARY], [PRIMARY], [PRIMARY], [PRIMARY], [PRIMARY], [PRIMARY], [PRIMARY], [PRIMARY], [PRIMARY], [PRIMARY], [PRIMARY])


ALTER TABLE [dbo].[CT_DONDATHANG] DROP CONSTRAINT [FK_CT_DONDATHANG_DONDATHANG]


ALTER TABLE [dbo].[PHIEUTHUHO] DROP CONSTRAINT [FK_PHIEUTHUHO_DONDATHANG]






ALTER TABLE [dbo].[DONDATHANG] DROP CONSTRAINT [PK__DONDATHA__603F0047CABA60BB] WITH ( ONLINE = OFF )


ALTER TABLE [dbo].[DONDATHANG] ADD PRIMARY KEY NONCLUSTERED 
(
	[MADH] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, IGNORE_DUP_KEY = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]


CREATE CLUSTERED INDEX [ClusteredIndex_on_NgayDatSc_637773026106670601] ON [dbo].[DONDATHANG]
(
	[NGAYDAT]
)WITH (SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF) ON [NgayDatSc]([NGAYDAT])


DROP INDEX [ClusteredIndex_on_NgayDatSc_637773026106670601] ON [dbo].[DONDATHANG]




ALTER TABLE [dbo].[CT_DONDATHANG]  WITH CHECK ADD  CONSTRAINT [FK_CT_DONDATHANG_DONDATHANG] FOREIGN KEY([MADH])
REFERENCES [dbo].[DONDATHANG] ([MADH])
ON UPDATE CASCADE
ON DELETE CASCADE
ALTER TABLE [dbo].[CT_DONDATHANG] CHECK CONSTRAINT [FK_CT_DONDATHANG_DONDATHANG]


ALTER TABLE [dbo].[PHIEUTHUHO]  WITH CHECK ADD  CONSTRAINT [FK_PHIEUTHUHO_DONDATHANG] FOREIGN KEY([MADH])
REFERENCES [dbo].[DONDATHANG] ([MADH])
ALTER TABLE [dbo].[PHIEUTHUHO] CHECK CONSTRAINT [FK_PHIEUTHUHO_DONDATHANG]








COMMIT TRANSACTION


